<!DOCTYPE html>
<html>
<head>
    <title>Listar Veículos</title>
</head>
<body>
    <h1>Lista de Veículos</h1>

    {% if user_is_authenticated %}
        <form action="/logout/" method="post" style="display:inline;">
            {% csrf_token %}
            <button type="submit">Logout</button>
        </form>
        {% if api_url %}
            <a href="{{ api_url }}" id="btn-api" style="margin-left:10px;">Ver API</a>
        {% endif %}

        {# Exibe token e exemplos de comando #}
        <div style="margin-top:15px; padding:10px; border:1px solid #ddd; max-width:800px;">
            <strong>Seu token de acesso:</strong>
            <pre style="background:#f8f8f8; padding:8px; overflow:auto;">{{ token }}</pre>

            <strong>Comando (usando header Authorization) -- Abra o terminal e cole o comando abaixo:</strong>
            <pre style="background:#f8f8f8; padding:8px; overflow:auto;">{{ api_cmd_header }}</pre>
        </div>
    {% else %}
        <a href="{% url 'registrar' %}" style="margin-right:10px;">Registrar</a>
        <a href="{% url 'login' %}" style="margin-right:10px;">Login</a>
    {% endif %}

    <a href="{% url 'cadastrar-veiculos' %}" class="requires-auth" style="margin-left:10px;">Cadastrar Novo Veículo</a>

    {% if veiculos %}
        <table border="1">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Marca</th>
                    <th>Modelo</th>
                    <th>Ano</th>
                    <th>Cor</th>
                    <th>Combustível</th>
                    <th>Foto</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for veiculo in veiculos %}
                    <tr>
                        <td>{{ veiculo.id }}</td>
                        <td>{{ veiculo.get_marca_display }}</td>
                        <td>{{ veiculo.modelo }}</td>
                        <td>{{ veiculo.ano }}</td>
                        <td>{{ veiculo.get_cor_display }}</td>
                        <td>{{ veiculo.get_combustivel_display }}</td>
                        <td>
                            {% if veiculo.foto %}
                                <img src="{{ veiculo.foto.url }}" alt="Foto" width="100">
                            {% else %}
                                Sem foto
                            {% endif %}
                        </td>
                        <td>
                            {% if veiculo.pk %}
                                <a href="{% url 'editar-veiculos' veiculo.pk %}" class="requires-auth">Editar</a>
                                <a href="{% url 'excluir-veiculos' veiculo.pk %}" class="requires-auth">Excluir</a>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>Nenhum veículo cadastrado.</p>
    {% endif %}

    
</body>
</html>